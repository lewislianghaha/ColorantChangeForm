需求及注意要点:
1)功能名:Akzo色母量转换(ColorantChangeForm)

2)此功能的核心思路如下:
=>修改一下色母后,将所有使用此色母的配方也要进行更新(注:不用理会产品系列,品牌以及版本)

3)注意要点:
=>必须要找到要更新的色母是对应那个三华内部色号(这样才能一一进行更新)

=>AKZO色母与YATU色母的转换关系步骤:
1)根据AKZO色母与三华色母找到对应的浓度系数
2)用AKZO色母*浓度系数=色母量中间值
3)依照第2步计算出各三华色母对应的色母量中间值再求和
4)最后使用公式:新色母量=单个色母量中间值/SUM(单个色母量中间值)*100 (20180911:经与良哥相量后,公式修改为新色母量=AKZO色母*浓度系数)


=>数据库准备(针对192.168.1.250服务器)
1)将AKZO DB库加入到SQL SERVER MANAGER内
2)在DB库内新建表半将"色母对照表"数据加上,字段如下:
  表名:ColorantContrast
  字段描述:
  Colorant nvarchar(100) pk,    三华色母
  AkzoColorant nvarchar(100),   Akzo色母
  Number number,                浓度系数(用于记录用户针对此色母所填写过的浓度系数)
  CredateDate datetime          创建日期(用于记录用户修改色母浓度系数日期)

3)在DB库新建表并将"色号对照表"数据加上,字段如下:
  表名:ColorCodeContrast
  字段描述:
  AkzoCode  nvarchar(100)      Akzo号
  InnerCode nvarchar(100)      三华内部色号

=>流程(核心算法)
  根据三华色号找出=>三华内部色号(根据"色号对照表"找到)=>AKZO号(根据"色母对照表"找到AKZO色母)=>找到对应的AKZO色母量(取MAX(VersionDate)对应的色母量)=>最后拼接成一个DATA TABLE=>Data Set内显示在GridView中

=>关键点:(重)
  1)从AKZO获取的色母量是获取"版本最新"的色母量(因为可能会有N个色母量)
  2)更新三华色母量有多少就更新多少(即不论有多少个版本日期对应的色母量)

=>色母转换功能:
  =>只能针对有AKZO号与三华号 及 AKZO色母与三华色母对应才能使用


Q&A:
Q:问良哥所填写的"Target"三华色母号是已在数据库中存在还是作为一个新的色母?
A:色母都是在原来三华调色系统里存在

Q:Puctid这一列对转换有没有起到什么作用?
A:只作产品系列区分之用

Q:色母转换这个功能主要用于对EXCEL中那一个列进行更新？并更新到三华调色系统的那个表内?是色母表还是那个表?
A:色母转换功能其实就是根据AKZO色母以及所设定的浓度系数计算得出新的色母量;然后对使用此色母的配方进行更新

Q:怎样知道要更新的色母是对应那个内部色号?(或清楚AKZO号如何与内部色号进行对应) 重
A:通过任工发过来的ColorContract.xlsx文件(就是AKZO号与三华内部色号对应表)  

Q:新表需不需要跟AKZO的DB库,因为若AKZO的DB库要换的话,这两个表要重建并且重新插入记录?
A:要